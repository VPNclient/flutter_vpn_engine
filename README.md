# VPN Client Engine

**Ğ•Ğ´Ğ¸Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¼Ğ¸ VPN ÑĞ´Ñ€Ğ°Ğ¼Ğ¸ Ğ¸ Ğ´Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ğ°Ğ¼Ğ¸ Ñ‚ÑƒĞ½Ğ½ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ.**

ĞŸĞ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ ĞºÑ€Ğ¾ÑÑĞ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼ĞµĞ½Ğ½Ğ¾Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ Ğ´Ğ»Ñ Android, iOS, Windows, Linux Ğ¸ macOS.

## ğŸš€ Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸

- âœ… **ĞœĞ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²Ğ¾ VPN ÑĞ´ĞµÑ€**: SingBox, LibXray, V2Ray, WireGuard
- âœ… **Ğ”Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ñ‹ Ñ‚ÑƒĞ½Ğ½ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ**: HevSocks5, Tun2Socks
- âœ… **ĞšÑ€Ğ¾ÑÑĞ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ**: Android, iOS, Windows, Linux, macOS
- âœ… **Subscription API**: ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¾Ğº Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸ĞµĞ¼
- âœ… **V2Ray URL Parser**: ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ vmess://, vless://, trojan://, ss://, socks://
- âœ… **Ping & Latency**: Ğ˜Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¸ ÑĞµÑ€Ğ²ĞµÑ€Ğ¾Ğ²
- âœ… **Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°**: ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ° Ğ¸ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ
- âœ… **ĞĞ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ**: Ğ›ĞµĞ³Ğ°ÑĞ¸ API Ğ´Ğ»Ñ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

## ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     VPNclient-green-app (Flutter)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  flutter_vpn_engine â”‚ â† Ğ•Ğ´Ğ¸Ğ½Ğ°Ñ Ñ‚Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ°
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                 â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚ Drivers  â”‚     â”‚   Cores    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚
    â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    â”‚    â”‚       â”‚    â”‚     â”‚        â”‚
â”Œâ”€â”€â”€â–¼â” â”Œâ”€â–¼â”€â”€â”€â”   â”Œâ”€â”€â”€â–¼â” â”Œâ”€â–¼â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”
â”‚Hev â”‚ â”‚Tun2 â”‚   â”‚Singâ”‚ â”‚LibX â”‚ â”‚V2Ray  â”‚
â”‚5   â”‚ â”‚Socksâ”‚   â”‚Box â”‚ â”‚ray  â”‚ â”‚       â”‚
â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

### 1. Ğ”Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ñ‹ (Drivers)
Ğ”Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ñ‹ Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°ÑÑ‚ Ğ·Ğ° Ñ‚ÑƒĞ½Ğ½ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ñ€Ğ°Ñ„Ğ¸ĞºĞ°:
- **HevSocks5** - hev-socks5-tunnel
- **Tun2Socks** - tun2socks

### 2. Ğ¯Ğ´Ñ€Ğ° (Cores)
Ğ¯Ğ´Ñ€Ğ° Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°ÑÑ‚ Ğ·Ğ° VPN Ğ¿Ñ€Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ»Ñ‹:
- **SingBox** - sing-box
- **LibXray** - libxray
- **V2Ray** - v2ray

## Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°

Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ² `pubspec.yaml`:

```yaml
dependencies:
  vpnclient_engine:
    path: ../flutter_vpn_engine
```

### Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

```dart
import 'package:vpnclient_engine/vpnclient_engine.dart';

// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸
final config = VpnEngineConfig(
  core: CoreConfig(
    type: CoreType.singbox,
    configJson: '''
    {
      "server": "example.com",
      "port": 443,
      "protocol": "vless"
    }
    ''',
  ),
  driver: DriverConfig(
    type: DriverType.hevSocks5,
    mtu: 1500,
  ),
);

// ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€Ğ° Ğ´Ğ²Ğ¸Ğ¶ĞºĞ°
final engine = VpnClientEngine.instance;

// Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
await engine.initialize(config);

// Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° callbacks
engine.setStatusCallback((status) {
  print('VPN Status: $status');
});

engine.setLogCallback((level, message) {
  print('[$level] $message');
});

// ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
await engine.connect();

// ĞÑ‚ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
await engine.disconnect();
```

### Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° ÑĞ¾ streams

```dart
// ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ½Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°
engine.statusStream.listen((status) {
  print('Status changed: $status');
});

// ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ½Ğ° ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ
engine.statsStream.listen((stats) {
  print('Traffic: ${stats.formattedTotalBytes}');
  print('Latency: ${stats.latencyMs}ms');
});

// ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ½Ğ° Ğ»Ğ¾Ğ³Ğ¸
engine.logStream.listen((log) {
  print('[${log['level']}] ${log['message']}');
});
```

### Ğ’Ñ‹Ğ±Ğ¾Ñ€ ÑĞ´Ñ€Ğ°

```dart
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ SingBox
final config1 = VpnEngineConfig(
  core: CoreConfig(type: CoreType.singbox, configJson: '...'),
);

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ LibXray
final config2 = VpnEngineConfig(
  core: CoreConfig(type: CoreType.libxray, configJson: '...'),
);

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ V2Ray
final config3 = VpnEngineConfig(
  core: CoreConfig(type: CoreType.v2ray, configJson: '...'),
);
```

### Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ´Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ğ°

```dart
// Ğ‘ĞµĞ· Ğ´Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ğ° (Ğ¿Ñ€ÑĞ¼Ğ¾Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ)
final config1 = VpnEngineConfig(
  core: CoreConfig(type: CoreType.singbox, configJson: '...'),
  driver: DriverConfig(type: DriverType.none),
);

// Ğ¡ HevSocks5
final config2 = VpnEngineConfig(
  core: CoreConfig(type: CoreType.singbox, configJson: '...'),
  driver: DriverConfig(
    type: DriverType.hevSocks5,
    mtu: 1500,
    tunAddress: '10.0.0.2',
  ),
);

// Ğ¡ Tun2Socks
final config3 = VpnEngineConfig(
  core: CoreConfig(type: CoreType.singbox, configJson: '...'),
  driver: DriverConfig(
    type: DriverType.tun2socks,
    mtu: 1500,
  ),
);
```

### ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸

```dart
// Ğ˜Ğ¼Ñ ÑĞ´Ñ€Ğ°
final coreName = await engine.getCoreName();
print('Core: $coreName');

// Ğ’ĞµÑ€ÑĞ¸Ñ ÑĞ´Ñ€Ğ°
final coreVersion = await engine.getCoreVersion();
print('Version: $coreVersion');

// Ğ˜Ğ¼Ñ Ğ´Ñ€Ğ°Ğ¹Ğ²ĞµÑ€Ğ°
final driverName = await engine.getDriverName();
print('Driver: $driverName');

// Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ ÑÑ‚Ğ°Ñ‚ÑƒÑ
final status = engine.status;
print('Status: $status');

// Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°
await engine.updateStats();
final stats = engine.stats;
print('Sent: ${stats.formattedBytesSent}');
print('Received: ${stats.formattedBytesReceived}');
```

## ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹

### SingBox + HevSocks5

```dart
final config = VpnEngineConfig(
  core: CoreConfig(
    type: CoreType.singbox,
    configJson: '''
    {
      "log": {"level": "info"},
      "inbounds": [{
        "type": "tun",
        "tag": "tun-in",
        "inet4_address": "172.19.0.1/30",
        "auto_route": true,
        "strict_route": true,
        "sniff": true
      }],
      "outbounds": [{
        "type": "vless",
        "server": "example.com",
        "server_port": 443,
        "uuid": "your-uuid",
        "flow": "xtls-rprx-vision",
        "tls": {
          "enabled": true,
          "server_name": "example.com"
        }
      }]
    }
    ''',
  ),
  driver: DriverConfig(
    type: DriverType.hevSocks5,
    mtu: 1500,
  ),
);
```

### LibXray + Tun2Socks

```dart
final config = VpnEngineConfig(
  core: CoreConfig(
    type: CoreType.libxray,
    configJson: '''
    {
      "log": {"loglevel": "info"},
      "inbounds": [{
        "port": 1080,
        "protocol": "socks",
        "settings": {"udp": true}
      }],
      "outbounds": [{
        "protocol": "vless",
        "settings": {
          "vnext": [{
            "address": "example.com",
            "port": 443,
            "users": [{
              "id": "your-uuid",
              "flow": "xtls-rprx-vision",
              "encryption": "none"
            }]
          }]
        },
        "streamSettings": {
          "network": "tcp",
          "security": "tls"
        }
      }]
    }
    ''',
  ),
  driver: DriverConfig(
    type: DriverType.tun2socks,
    mtu: 1500,
  ),
);
```

## Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ

MIT License - ÑĞ¼. LICENSE Ñ„Ğ°Ğ¹Ğ»

## ĞĞ²Ñ‚Ğ¾Ñ€Ñ‹

VPNclient Team
